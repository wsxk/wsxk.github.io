---
layout: post
tags: [iot_dev]
date: 2023-8-13
author: wsxk
comments: true
title: "iot dev technology"
---

- [1. 第一个嵌入式系统](#1-第一个嵌入式系统)
  - [boot的作用](#boot的作用)

## 1. 第一个嵌入式系统<br>
入门嵌入式系统开发，需要了解嵌入式开发和传统PC程序开发的差别和联系。<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-7-6/20230923211703.png)
从图中可以看出，虽然嵌入式开发和PC程序开发使用的工具基本上没有相似之处，但是开发流程和编写代码的基本思想都是类似的。<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-7-6/20230923211906.png)

```
Step01：CPU会到特定的地址获取第一行指令来执行（boot），实际的细节有两种。   
    1. CPU重新启动后，将其PC（Program Counter）寄存器设为特定地址，只要user的程序确实存储在这个地址，就可以正确被执行。
    2. CPU重新启动后，会将CPU中存储中断矢量表地址的寄存器设为某特定地址，接着引发‘RESET中断’，所以程序员只要把中断矢量表存储在这个地址，并指定‘Reset中断的处理程序’为自己写的某个函数（如：boot()），则该函数就可以在开机后被CPU执行

Step02：User程序开始运行后，会先对CPU做初始化的动作。

Step03：将程序的数据段从只读存储器（ROM或Flash）载入到RAM中。

Step04：CPU初始化完毕后，紧接着会初始化应用程序用到的硬设备。

Step05：初始化各个子系统，如嵌入式操作系统（RTOS）、动态存储器管理、图形界面系统等。

Step06：执行应用程序的主程序。
```
**所谓的中断矢量表就是从某个地址开始，每4个Byte为一个单位（entry），每一个entry记录一个函数的地址**<br>

### boot的作用<br>
上面提到的执行主程序之前的操作，都由boot来完成<br>
boot具体作如下几件事<br>
```
Step01：设定某些重要的CPU寄存器，特别是堆栈指针寄存器（Stack Pointer；简称SP）与状态寄存器（Status Register）(状态寄存器：在大部分的初始化动作还未完成之前，此时，若产生中断是很麻烦的事情。所以在boot阶段最重要的事就是命令CPU禁止中断产生，直到初始化动作都做完后，才把中断功能打开。CPU的状态寄存器由很多状态标志组成，通常都会包含用来设定CPU是否接受中断的标志。)

Step02：CPU各部分功能初始化。

Step03：系统初始化。

Step04：调用应用程序的主程序。

Step05：结束（通常应用程序的主程序不会返回boot程序）
```
第5章：实作你的第一个嵌入式系统■　
第6章：实作嵌入式系统平台■　
第7章：构建良好的嵌入式系统开发环境■　
第8章：上电之后：Boot Loader■　
第9章：驱动程序■　
第10章：设计硬件抽象层■　
第11章：菜鸟当自强：软件工程师硬起来■　
第12章：做好存储器管理■　
第13章：存储器管理（II）：NAND Flash概论■　
第14章：模拟器■　
附录B：Callback Function■　
附录C：用C来实作面向对象的概念
