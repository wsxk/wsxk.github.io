---
layout: post
tags: [RealWorld]
title: "CVE-2024-0352å¤ç°(likeshop v2.5.7æ–‡ä»¶ä¸Šä¼ æ¼æ´)"
author: wsxk
comments: true
date: 2024-9-9
---

- [1. æ¼æ´æè¿°](#1-æ¼æ´æè¿°)
- [2. æ¼æ´å¤ç°](#2-æ¼æ´å¤ç°)
- [3. æ¼æ´åˆ†æ](#3-æ¼æ´åˆ†æ)
- [4. æ¼æ´ä¿®è¡¥æ–¹æ¡ˆ](#4-æ¼æ´ä¿®è¡¥æ–¹æ¡ˆ)
- [references](#references)


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C22S5YSYL7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C22S5YSYL7');
</script>

## 1. æ¼æ´æè¿°<br>
likeshopæ˜¯ä¸€æ¬¾å¼€æºçš„å•å•†æˆ·å•†åŸç³»ç»Ÿï¼Œäº§å“å®šä½ä¸ºB2Cæ¨¡å¼ï¼Œç±»ä¼¼äº¬ä¸œè‡ªè¥å•†åŸã€‚å¯ä»¥åœ¨[https://github.com/likeshop-github/likeshop](https://github.com/likeshop-github/likeshop)æœåˆ°å…¶å¼€æºä»£ç 
å…è´¹ä¼ä¸šç‰ˆå’Œä»˜è´¹ä¼ä¸šç‰ˆåŠŸèƒ½åŸºæœ¬ç›¸åŒï¼Œåªè½åäº†ä»˜è´¹ä¼ä¸šç‰ˆå‡ ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸è‰¯å¿ƒäº†<br>
æ¼æ´å‡ºç°åœ¨`version <= 2.5.7.20210311`ä¸­ï¼Œä¸ºä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œæ”»å‡»è€…å¯é€šè¿‡æ­¤æ¼æ´ä¸Šä¼ æœ¨é©¬è·å–æœåŠ¡å™¨æƒé™<br>


## 2. æ¼æ´å¤ç°<br>
å¤ç°ç¯å¢ƒä¸º`ubuntu20.04`<br>
é¦–å…ˆéœ€è¦ä¸‹è½½æºç åŒ…<br>
[https://github.com/likeshop-github/likeshop/releases/tag/2.5.7](https://github.com/likeshop-github/likeshop/releases/tag/2.5.7)<br>
å°†ä»£ç åŒ…è§£å‹åï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤<br>
```
apt install php7.4-gd
apt install php7.4-curl
apt install php7.4-xml
apt install composer
apt install php-mysql
apt install mysql-server

cd server
composer install
php think run --host 0.0.0.0 --port 8000
```
å®Œæˆä¸Šè¿°å‘½ä»¤åï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®`IP:8000`åº”è¯¥å¯ä»¥çœ‹åˆ°ç•Œé¢<br>
**æ³¨æ„ï¼Œåœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¼šè¦æ±‚ä½ è¾“å…¥mysqlæ•°æ®åº“çš„è´¦å·åå¯†ç ï¼Œé»˜è®¤è´¦å·å¯†ç åœ¨/etc/mysql/debian.cnfä¸‹**<br>
ä¸€å¼€å§‹ç™»å½•`127.0.0.1:8000/admin`æ˜¯ç®¡ç†è€…é¡µé¢ï¼Œè¦æƒ³éªŒè¯pocï¼Œéœ€è¦è®¿é—®`http://127.0.0.1:8000/mobile/`é¡µé¢ï¼Œå¹¶æ³¨å†Œä¸€ä¸ªè´¦å·<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240905222733.png)

é—®é¢˜å‡ºç°åœ¨å¤´åƒçš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ä¸Šï¼Œå¯ä»¥ä¸Šä¼ `.php`æ–‡ä»¶ï¼<br>
é€šè¿‡burpæŠ“åŒ…ï¼Œå¯ä»¥æŠ“åˆ°è¯·æ±‚<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240906195807.png)
è¯·è¿”å›æŠ¥æ–‡å¦‚ä¸‹æ‰€ç¤º:<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240906195844.png)
å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„æ˜¯`http:\/\/127.0.0.1:8000\/uploads\/user\/20240906195742ab9137289.php`<br>
å¯ä»¥æ— éœ€æƒé™ç›´æ¥è®¿é—®è¯¥url(å½“ç„¶ï¼Œ`127.0.0.1`è¦æ”¹æˆä½ è®¿é—®çš„ipåœ°å€)<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240906200130.png)
æ¼æ´å¤ç°æˆåŠŸï¼ˆbtwï¼Œè¿™å¹´å¤´çœ‹åˆ°è¿™ä¹ˆä¼ ç»Ÿçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´å¯çœŸæ˜¯ä¸å®¹æ˜“<br>


## 3. æ¼æ´åˆ†æ<br>
æ ¹æ®httpè¯·æ±‚è·¯ç”±`formimage`å¯ä»¥æ‰¾åˆ°ä»£ç æ‰€åœ¨ä½ç½®ä¸º`server\application\api\controller`<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240907083445.png)
ç»§ç»­å¾€ä¸‹åˆ†æï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä»£ç :<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240907084116.png)
`setUploadFileå’Œupload`è¿™ä¸¤ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬è¦é‡ç‚¹å…³æ³¨çš„äº†ã€‚<br>
ç»§ç»­å¾€ä¸‹æŒ–ï¼Œå¯ä»¥çœ‹åˆ°`setUploadFile`çš„å®ç°<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240907085038.png)
`upload`çš„å®ç°ä¸å†å¤šè°ˆï¼Œæ€»ä¹‹ä¹Ÿæ˜¯æ²¡æœ‰æ ¡éªŒ<br>
æ‰€ä»¥åœ¨æˆ‘ä¸ªäººçœ‹æ¥ï¼Œé—®é¢˜æœ‰ä¸‰ç‚¹:<br>
**1. ä¸Šä¼ æ–‡ä»¶æ—¶æ²¡æœ‰æ ¡éªŒæ–‡ä»¶**<br>
**2. ä¸Šä¼ æˆåŠŸåè¿”å›äº†æœåŠ¡å™¨è·¯å¾„ï¼Œå¯é€šè¿‡urlè¿›è¡Œè®¿é—®**<br>
**3. æ²¡æœ‰é™åˆ¶ç”¨æˆ·è®¿é—®ä¸Šä¼ åçš„æ–‡ä»¶**<br>


## 4. æ¼æ´ä¿®è¡¥æ–¹æ¡ˆ<br>
æ–°ç‰ˆæœ¬ä¸­æ·»åŠ äº†`æ–‡ä»¶åç¼€æ ¡éªŒ`<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240907091401.png)
ğŸ¤”æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼Œå¦‚æœä¿®æ”¹åç¼€ï¼Œèƒ½ä¸èƒ½ç»•è¿‡å‘¢?<br>
è¯•äº†ä¸€ä¸‹ï¼Œä¸è¡Œ<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2024-3-25/20240907092549.png)

## references<br>
[likeshopå®˜ç½‘](https://www.likeshop.cn/)<br>
[likeshop v2.5.7æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æ(CVE-2024-0352)](https://xz.aliyun.com/t/13431?time__1311=Gqmxu7G%3D5Wq05DK5YK0%3DeKGKKjfKTbT4D)<br>
[CVE-2024-0352 likeshop v2.5.7æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æ](http://www.mzph.cn/news/657258.shtml)<br>
[[æ¼æ´å¤ç°]CVE-2024-0352](https://cn-sec.com/archives/2397812.html)<br>
