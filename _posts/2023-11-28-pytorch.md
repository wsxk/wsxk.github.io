---
layout: post
tags: [AI]
title: "pytorch learning"
date: 2023-11-28    
author: wsxk
comments: true
---

- [1. install](#1-install)
- [2. dir/help](#2-dirhelp)
- [3. pytorch教程](#3-pytorch教程)
  - [3.1 读取数据](#31-读取数据)
  - [3.2 画图](#32-画图)


## 1. install<br>
请看[https://wsxk.github.io/AI_env/](https://wsxk.github.io/AI_env/)<br>

## 2. dir/help<br>
**dir用于查看一个库中有哪些组件，help用于查看组件的具体用法**<br>
```python
import torch
if __name__ == '__main__':
    print(dir(torch))
    print((dir(torch.cuda)))
    print(help((torch.cuda.is_available)))
```
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-7-6/20231128224945.png)

## 3. pytorch教程<br>
### 3.1 读取数据<br>
```python
from torch.utils.data import Dataset
from PIL import Image
import os


class MyData(Dataset):
    # root_dir: 图片所在上一层目录相对路径
    # label_dir: 图片所在当前目录名称
    def __init__(self, root_dir, label_dir):
        self.root_dir = root_dir
        self.label_dir = label_dir
        self.image_path = os.path.join(self.root_dir, self.label_dir)
        self.image_list = os.listdir(self.image_path)

    def __getitem__(self, idx):
        image_name = self.image_list[idx]
        img_item_path = os.path.join(self.image_path, image_name)
        image = Image.open(img_item_path)
        label = self.label_dir
        return image, label

    def __len__(self):
        return len(self.image_list)
```

### 3.2 画图<br>
```python
from torch.utils.tensorboard import SummaryWriter
from PIL import Image
import numpy as np

writer = SummaryWriter("logs")
image_path = "DataSet/hymenoptera_data/train/ants/0013035.jpg"
image_pil = Image.open(image_path)
image_array = np.array(image_pil)
writer.add_image("picture",image_array,1,dataformats="HWC") # tag y轴 x轴 通道（height width channel）

# for i in range(100):
#     writer.add_scalar("y=2x",2*i,i)  # y=2x曲线 y轴 x轴
writer.close()
```
