---
layout: post
tags: [c++]
title: "c++ é¢„å¤„ç†ç¼–è¯‘é“¾æ¥ & å¼•ç”¨ & ç±» & static & æ„é€  & ææ„"
date: 2023-2-21
author: wsxk
comments: true
---

- [é¢„å¤„ç†](#é¢„å¤„ç†)
- [ç¼–è¯‘](#ç¼–è¯‘)
- [é“¾æ¥](#é“¾æ¥)
	- [ç¥ç§˜é”™è¯¯](#ç¥ç§˜é”™è¯¯)
- [å¤´æ–‡ä»¶](#å¤´æ–‡ä»¶)
- [å¼•ç”¨](#å¼•ç”¨)
- [ç±»](#ç±»)
	- [classå’Œstructçš„åŒºåˆ«](#classå’Œstructçš„åŒºåˆ«)
	- [å¦‚ä½•ä½¿ç”¨ç±»](#å¦‚ä½•ä½¿ç”¨ç±»)
- [c++ä¸­çš„å…¨å±€é™æ€](#cä¸­çš„å…¨å±€é™æ€)
- [c++ç±»ä¸­çš„static](#cç±»ä¸­çš„static)
- [c++ä¸­çš„å±€éƒ¨static](#cä¸­çš„å±€éƒ¨static)
- [æ„é€ ](#æ„é€ )
- [ææ„](#ææ„)


## é¢„å¤„ç†<br>
é¢„å¤„ç†æœ‰3ä¸ªç»å¸¸ç”¨çš„ä¸œè¥¿`#include`,`#define`,`#if #endif`<br>
å…¶å®é¢„å¤„ç†çš„æ„æ€å¤§æ¦‚å°±æ˜¯ï¼ŒåŸæ–‡æ›¿æ¢<br>
æœ‰ä¸€ä¸ªa.hæ–‡ä»¶
```c
void test(){
    return ;
}
```
æœ‰ä¸€ä¸ªa.cæ–‡ä»¶
```c
#include "a.h"
void test2(){
    test();
}
```
ç»è¿‡é¢„å¤„ç†åï¼Œå®é™…çš„a.cæ–‡ä»¶æ˜¯è¿™æ ·çš„
```c
void test(){
    return ;
}
void test2(){
    test();
}
```

## ç¼–è¯‘<br>
ç¼–è¯‘å…¶å®å°±æ˜¯æŠŠæºä»£ç `.cpp`è½¬æ¢æˆäºŒè¿›åˆ¶ä»£ç `.obj`<br>
å…³æ³¨ç‚¹æ˜¯ï¼Œåº”è¯¥æ˜ç™½`å£°æ˜(declaration)`å’Œ`å®šä¹‰(definition)`çš„åŒºåˆ«ã€‚<br>
> 1. å£°æ˜æŒ‡çš„æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯å­˜åœ¨çš„
> 2. å®šä¹‰å°±æ˜¯ï¼Œè¿™ä¸ªä¸œè¥¿åˆ°åº•æ˜¯ä»€ä¹ˆ
>

## é“¾æ¥<br>
æŠŠä¸€ä¸ªé¡¹ç›®çš„æ‰€æœ‰çš„`.obj`é“¾æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº`.exe`<br>
`static` åœ¨å‡½æ•°å‰ï¼Œè¡¨ç¤ºè¿™ä¸ªå‡½æ•°åªä¼šåœ¨è¿™ä¸ªæ–‡ä»¶è¢«ä½¿ç”¨ï¼ˆå…é™¤é“¾æ¥é˜¶æ®µï¼‰<br>
`inline` åœ¨å‡½æ•°å»ï¼Œè¿™ä¸ªå‡½æ•°è¢«å…¶ä»–å‡½æ•°è°ƒç”¨æ—¶æ•ˆæœå’Œ`#include`ä¸€æ ·<br>

### ç¥ç§˜é”™è¯¯<br>
æœ‰ä¸ªæ–‡ä»¶`Log.h`
```c++
#pragma once
#include <iostream>
void Log(const char* message) {
	std::cout << message << std::endl;
}
```
å¦ä¸€ä¸ªæ–‡ä»¶`Log.cpp`
```c++
#include "Log.h"

void init_log() {
	Log("init_log");
}
```
è¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶`math.cpp`
```c++
#include <iostream>
#include "Log.h"
static int multiply(int a, int b) {
	int result = a * b;
	Log("multiply");
	return result;
}
int main() {
	std::cout << multiply(5, 8) << std::endl;

}
```

åœ¨é“¾æ¥é˜¶æ®µä¼šæŠ¥é”™ï¼Œå› ä¸º`#include`çš„ç‰¹æ€§ï¼Œå®é™…ä¸Š`Log`å‡½æ•°è¢«å®šä¹‰äº†2æ¬¡ã€‚<br>

**è§£å†³åŠæ³•**<br>
> 1. ä½¿ç”¨ static å…³é”®å­—
> 2. ä½¿ç”¨ inline å…³é”®å­—
> 3. å¤´æ–‡ä»¶ä¸è¦å®šä¹‰ï¼ï¼ï¼ 


## å¤´æ–‡ä»¶<br>
```c
#pragma once // æ”¹å¤´æ–‡ä»¶åªåŒ…å«ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ä¼šé‡å¤å£°æ˜
#ifndef _LOG_H // ifndef å’Œ #pragma onceçš„ä½œç”¨ç›¸åŒ
#define _LOG_H
#include <iostream>
inline void Log(const char* message);
struct player{};
#endif
```


## å¼•ç”¨<br>
c++çš„å¼•ç”¨å…¶å®æ˜¯ä¸€ç§`semantic sugar`ã€‚<br>
å¼•ç”¨ç›¸å½“äºç»™å˜é‡èµ·ä¸€ä¸ªåˆ«åã€‚<br>
**å› æ­¤ï¼Œå¼•ç”¨åœ¨å£°æ˜æ—¶å°±å¿…é¡»æœ‰ä¸€ä¸ªå®šä¹‰ï¼Œå¹¶ä¸”è¿™ä¸ªå®šä¹‰åœ¨è¿™ä¸ªç¨‹åºä¸­æ— æ³•è¢«æ›´æ”¹**<br>
```c++
int x = 6;
int b = 3;
std::cout << x << std::endl;
int& ref=x; //è¿™ä¸ªç¨‹åºä¸­ï¼Œrefåªèƒ½æ˜¯xçš„åˆ«å
ref= b; //ç›¸å½“äº x = b
```
å…¶å®å¼•ç”¨è¿™ç§ç”¨æ³•åœ¨æ™®é€šç¼–å†™ä»£ç æ—¶æ˜¾å¾—æ²¡æœ‰å¿…è¦ï¼Œä½†æ˜¯åœ¨å‡½æ•°ä¼ å‚ä¸­å°±æ¯”è¾ƒæœ‰ç”¨äº†ã€‚<br>
```c++
int increment(int& x) {
	x++;
	return 0;
}

int main() {
	int x = 6;
	int b = 3;
	std::cout << x << std::endl;
	int& ref=x;
	increment(x);

	std::cout << x << std::endl;	
}
```
ç”¨è¿™ç§åŠæ³•ï¼Œç›¸æ¯”äºæŒ‡é’ˆï¼Œä½¿å¾—ä»£ç æ¸…æ™°å¥½çœ‹äº†ä¸å°‘ï¼ˆğŸ˜€å…¶å®è¿™å°±æ˜¯å¼•ç”¨çš„ä½œç”¨ï¼‰<br>
**å¼•ç”¨èƒ½åšçš„ï¼ŒæŒ‡é’ˆä¹Ÿèƒ½åšï¼›å¼•ç”¨ä¸èƒ½åšçš„ï¼ŒæŒ‡é’ˆä¹Ÿæ— æ³•åšåˆ°**<br>
**å®é™…ä¸Šå¼•ç”¨çš„åº•å±‚é€»è¾‘å°±æ˜¯æŒ‡é’ˆ**<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-2-18-reverse/20230228131703.png)
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-2-18-reverse/20230228131733.png)


## ç±»<br>
ç±»æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€ç§æ¦‚å¿µ<br>
ç±»æ˜¯ä¸€ç§ç‰©ä½“çš„å®è§‚æè¿°ï¼ˆdata åŠ  functionï¼‰<br>
```c
class player {
public:
	int x, y, speed;
	void move(int xa, int ya, int speeda) {
		x += xa * speeda;
		y += ya * speeda;
	}
};

int main() {
	player playerx, playery;
	playerx.x = 1;
	playerx.y = 1;
	playerx.speed = 2;
	playerx.move(2, 4, 5);
	std::cout << playerx.x<< std::endl;
}
```

### classå’Œstructçš„åŒºåˆ«<br>
å…¶å®å”¯ä¸€çš„åŒºåˆ«æ˜¯é»˜è®¤çš„å¯è§æ€§ã€‚<br>
**classé»˜è®¤ç§æœ‰ï¼ˆprivateï¼‰ï¼Œstructé»˜è®¤å…¬å¼€ï¼ˆpublicï¼‰**<br>
```c++
struct player {
	int x, y, speed;
	void move(int xa, int ya, int speeda) {
		x += xa * speeda;
		y += ya * speeda;
	}
};

int main() {
	player playerx, playery;
	playerx.x = 1;
	playerx.y = 1;
	playerx.speed = 2;
	playerx.move(2, 4, 5);
	std::cout << playerx.x<< std::endl;
}
```
è¿™æ®µä»£ç è·Ÿä¸Šä¸€æ®µä»£ç æ˜¯åŒä¸€ä¸ªæ•ˆæœã€‚<br>
è™½ç„¶å®é™…ä¸Š`struct`å’Œ`class`åœ¨æŠ€æœ¯ä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œä½†æ˜¯å¤§å¤šæ•°äººéƒ½å¯¹å®ƒä»¬ä¸¤ä¸ªåšäº†åŒºåˆ†ã€‚<br>
> 1. structç”¨åœ¨å°‘é‡çš„æ•°æ®æ“ä½œä¸Šï¼Œclassç”¨åœ¨æ¯”è¾ƒå¤æ‚çš„è¡Œä¸ºä¸Šï¼ˆæ¯”å¦‚ç©å®¶çš„å±æ€§ï¼ŒåŠŸèƒ½ï¼Œetcï¼‰
> 2. ç”¨åœ¨ç»§æ‰¿ï¼ˆinheritï¼‰ä¸Šï¼Œæ™®éç”¨æ³•éƒ½æ˜¯class


### å¦‚ä½•ä½¿ç”¨ç±»<br>
```c++
#include <iostream>

class Log {
public:
	const int LogLevelError = 0;
	const int LogLevelWarning = 1;
	const int LogLevelInfo = 2;
private:
	int m_LogLevel;
public:
	void SetLogLevel(int level) {
		m_LogLevel = level;
	}
	void LogError(const char* message) {
		if (m_LogLevel >= LogLevelError) {
			std::cout << "[ERROR]: " << message << std::endl;
		}
	}
	void LogWarning(const char* message) {
		if (m_LogLevel >= LogLevelWarning) {
			std::cout << "[WARNING]: " << message << std::endl;
		}
	}
	void LogInfo(const char* message) {
		if (m_LogLevel >= LogLevelInfo) {
			std::cout << "[INFO]: " << message << std::endl;
		}
	}
};

int main() {
	Log log;
	log.SetLogLevel(log.LogLevelWarning);
	log.LogError("hello");
	log.LogWarning("hello");
	log.LogInfo("hello");
	
}
```

## c++ä¸­çš„å…¨å±€é™æ€<br>
```c++
static int i;
static void func(){
    ;
};
```
ç”¨åœ¨å…¨å±€å˜é‡å½“ä¸­è¡¨æ˜åªåœ¨å½“å‰ç¿»è¯‘å•å…ƒï¼ˆå³å½“å‰æ–‡ä»¶ä¸­å¯è§<br>

## c++ç±»ä¸­çš„static<br>
```c++
struct Entity {
	static int x, y;
	static void print() {
		std::cout << x << y << std::endl;
	}
};

int Entity::x;
int Entity::y;
```
**è¡¨æ˜æ‰€æœ‰ç±»çš„å®ä¾‹å…±äº«è¿™ä¸€ä¸ªé™æ€å˜é‡ã€‚**<br>
ä½¿ç”¨æ—¶éœ€è¦ç”¨å¦‚ä¸‹æ ¼å¼:<br>
```c++
Entity::x = 4;
Entity::y = 5;
Entity::print();
```

**æ³¨æ„ï¼Œç±»å½“ä¸­çš„é™æ€å‡½æ•°ä¸èƒ½è®¿é—®éé™æ€å˜é‡ï¼Œå› ä¸ºä»–ä¸çŸ¥é“éé™æ€å˜é‡æŒ‡å‘è°**<br>


## c++ä¸­çš„å±€éƒ¨static<br>
```c++
void func(){
    static int i =0;
    i++;
    std::cout<<i<<std::endl;
}
```
**å±€éƒ¨staticåªä¼šåˆ›å»ºä¸€æ¬¡å¹¶ä¸€ç›´åˆ°ç¨‹åºç»ˆæ­¢æ—¶éƒ½å­˜æ´»ï¼Œåªä¸è¿‡åªèƒ½åœ¨å½“å‰å‡½æ•°ä¸­è®¿é—®å®ƒã€‚**<br>

## æ„é€ <br>
æ„é€ å‡½æ•°ï¼Œå½“å£°æ˜ä¸€ä¸ªç±»å®ä¾‹æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œåˆå§‹åŒ–ç±»çš„æŸäº›æ•°æ®å’ŒåŠŸèƒ½ã€‚<br>

```c++
#include <iostream>
class Entity {
public:
	float x, y;
	Entity() {  // å¿…é¡»ä¸ç±»åç§°åŒå
		x = 0.0f;
		y = 0.0f;
	}
	Entity(float X, float Y) {
		x = X;
		y = Y;
	}
	void print() {
		std::cout << x <<','<< y << std::endl;
	}
};

int main() {

	Entity e(3,4);
	e.print();

}	
```

## ææ„<br>
```c++
#include <iostream>
class Entity {
public:
	float x, y;
	Entity() {
		x = 0.0f;
		y = 0.0f;
	}
	Entity(float X, float Y) {
		x = X;
		y = Y;
	}
	~Entity() {
		std::cout << "Destory Entity" << std::endl;
	}
	void print() {
		std::cout << x <<','<< y << std::endl;
	}
};

void function() {
	Entity e(3, 4);
	e.print();
	e.~Entity();
}

int main() {

	function();

}	
```