---
layout: post
tags: [re]
title: "å‡½æ•°è¯†åˆ«:åˆ¶ä½œsigæ–‡ä»¶"
date: 2023-2-18
author: wsxk
comments: true
---

- [å¼•è¨€](#å¼•è¨€)
- [sigæ–‡ä»¶](#sigæ–‡ä»¶)
- [åˆ¶ä½œsigæ–‡ä»¶](#åˆ¶ä½œsigæ–‡ä»¶)
  - [1.ç”¨obj/libæ–‡ä»¶åˆ¶é€ PATæ–‡ä»¶](#1ç”¨objlibæ–‡ä»¶åˆ¶é€ patæ–‡ä»¶)
  - [2.å¤šè”åˆpatç”Ÿæˆsigæ–‡ä»¶](#2å¤šè”åˆpatç”Ÿæˆsigæ–‡ä»¶)


## å¼•è¨€<br>
å¤§ğŸ”¥åœ¨ä½¿ç”¨idaæ—¶ç»å¸¸ä¼šé‡åˆ°ä¸€äº›æƒ…å½¢<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-2-18-reverse/20230218133540.png)<br>
idaæ˜¯å¦‚ä½•è¯†åˆ«äºŒè¿›åˆ¶ç¨‹åºçš„å‡½æ•°åç§°å‘¢?<br>

## sigæ–‡ä»¶<br>
IDAé€šè¿‡`sig`æ–‡ä»¶å¯¹å‡½æ•°è¿›è¡Œè¯†åˆ«ï¼Œåœ¨IDAå†…éƒ¨é¢„è®¾äº†ä¸€äº›`sig`æ–‡ä»¶ï¼Œå°±åœ¨IDAå®‰è£…çš„`sigç›®å½•`ä¸‹ã€‚<br>
![](https://raw.githubusercontent.com/wsxk/wsxk_pictures/main/2023-2-18-reverse/20230218133846.png)

## åˆ¶ä½œsigæ–‡ä»¶<br>
### 1.ç”¨obj/libæ–‡ä»¶åˆ¶é€ PATæ–‡ä»¶
é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œåˆ¶é€ sigæ–‡ä»¶éœ€è¦æœ‰`obj/lib`æ–‡ä»¶ã€‚<br>
> objæ–‡ä»¶ å³åŒ…å«ä¸€ä¸ªç¨‹åºçš„å‡½æ•°åç§°åŠå…¶äºŒè¿›åˆ¶ä»£ç çš„æ–‡ä»¶
> libæ–‡ä»¶ libæ–‡ä»¶ä¸­åŒ…å«è‹¥å¹²objæ–‡ä»¶

å°†`obj/lib`æ–‡ä»¶åˆ¶ä½œæˆ`PAT`æ–‡ä»¶<br>
> PATæ–‡ä»¶ï¼Œä»obj/libä¸­æå–çš„å‡½æ•°åç§°å’ŒäºŒè¿›åˆ¶ç‰¹å¾ç <br>

ç”¨IDA7.0ä¸­å¸¦æœ‰çš„`flair70`æ¥è¿›è¡Œæ–‡ä»¶çš„è½¬æ¢<br>
**1.æ·»åŠ flair70ç›®å½•åˆ°ç¯å¢ƒå˜é‡ä¸­**<br>
**2.ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤**<br>
```
pcf [Obj name].obj 
pcf [Lib name].lib
//ä¸Šè¿°2æ¡å‘½ä»¤ç”¨äºç”Ÿæˆpatæ–‡ä»¶ï¼Œpcfç”¨äºåˆ¶é€ COFFæ–‡ä»¶æ ¼å¼(.obj,.lib)ï¼Œpelfç”¨äºåˆ¶é€ ELFæ–‡ä»¶æ ¼å¼(.o,.a)
```

### 2.å¤šè”åˆpatç”Ÿæˆsigæ–‡ä»¶<br>
`sigmake [Pat name].pat [Sig name].sig //*.pat`ä¼šæå–å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰patæ–‡ä»¶åˆæˆä¸€ä¸ªsigæ–‡ä»¶<br>
å†™ä¸€ä¸ªæ‰¹å¤„ç†è„šæœ¬æ¥å®ç°ä¸€é”®æ“ä½œ<br>
```bat
if %1==""  goto end 
for %%i in (*.lib,*.obj) do (pcf %%i)	
sigmake -r *.pat %1.sig
del *.pat
:end
```
**å°†ç”Ÿæˆçš„sigæ–‡ä»¶æ”¾å…¥idaç›®å½•ä¸‹çš„sigæ–‡ä»¶å¤¹ä¸­**<br>

